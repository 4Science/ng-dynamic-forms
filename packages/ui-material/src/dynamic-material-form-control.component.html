<div [formGroup]="group" [ngClass]="[getClass('element', 'container'), getClass('grid', 'container')]">

    <label *ngIf="model.label && !hasMatFormField && model.type !== 'CHECKBOX'"
           [for]="model.id"
           [innerHTML]="model.label"
           [ngClass]="[getClass('element', 'label'), getClass('grid', 'label')]"></label>

    <ng-container *ngTemplateOutlet="templates[0]?.templateRef; context: model"></ng-container>

    <ng-container #componentViewContainer></ng-container>

    <!-- FORM ARRAY --------------------------------------------------------------------------------------------------->
    <div *ngIf="isFormArray"
         [dynamicId]="bindId && model.id"
         [formArrayName]="model.id"
         [ngClass]="[getClass('element', 'control'), getClass('grid', 'control')]">

        <div *ngFor="let groupModel of model.groups; let idx = index" role="group"
             [formGroupName]="idx" [ngClass]="[getClass('element', 'group'), getClass('grid', 'group')]">

            <dynamic-material-form-control *ngFor="let _model of groupModel.group"
                                           [bindId]="false"
                                           [context]="groupModel"
                                           [group]="control.at(idx)"
                                           [hidden]="_model.hidden"
                                           [layout]="layout"
                                           [model]="_model"
                                           [templates]="templateList"
                                           [ngClass]="[getClass('element', 'host', _model), getClass('grid', 'host', _model)]"
                                           (blur)="onBlur($event)"
                                           (change)="onValueChange($event)"
                                           (focus)="onFocus($event)"
                                           (matEvent)="onCustomEvent($event)"></dynamic-material-form-control>

            <ng-container *ngTemplateOutlet="templates[2]?.templateRef; context: groupModel"></ng-container>

        </div>

    </div>

    <!-- FORM GROUP --------------------------------------------------------------------------------------------------->
    <div *ngIf="isFormGroup" role="group"
         [dynamicId]="bindId && model.id"
         [formGroupName]="model.id"
         [ngClass]="[getClass('element', 'control'), getClass('grid', 'control')]">

        <dynamic-material-form-control *ngFor="let _model of model.group"
                                       [group]="control"
                                       [hidden]="_model.hidden"
                                       [layout]="layout"
                                       [model]="_model"
                                       [templates]="templateList"
                                       [ngClass]="[getClass('element', 'host', _model), getClass('grid', 'host', _model)]"
                                       (blur)="onBlur($event)"
                                       (change)="onValueChange($event)"
                                       (focus)="onFocus($event)"
                                       (matEvent)="onCustomEvent($event)"></dynamic-material-form-control>
    </div>

    <ng-container *ngIf="!hasMatFormField && showErrorMessages">

        <mat-error *ngFor="let message of errorMessages">{{ message }}</mat-error>

    </ng-container>

    <ng-container *ngTemplateOutlet="templates[1]?.templateRef; context: model"></ng-container>

    <ng-content></ng-content>

</div>
